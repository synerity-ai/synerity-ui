<div class="sui-tree-wrapper">
  <!-- Filter -->
  <div *ngIf="filter" class="sui-tree-filter">
    <div class="sui-tree-filter-container">
      <div class="sui-tree-filter-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
      </div>
      <input
        type="text"
        [placeholder]="filterPlaceholder"
        (input)="onFilter($event)"
        class="sui-tree-filter-input"
      />
    </div>
  </div>
  
  <!-- Tree Container -->
  <div class="sui-tree-content">
    <div class="sui-tree-nodes">
      <div *ngFor="let node of filteredValue" class="sui-tree-node">
        <!-- Root Node -->
        <div 
          class="sui-tree-node-item"
          [class.sui-tree-node-selected]="isNodeSelected(node)"
          (click)="onNodeClick(node, $event)"
        >
          <!-- Toggle Button -->
          <button
            *ngIf="hasChildren(node)"
            type="button"
            (click)="toggleNode(node); $event.stopPropagation()"
            class="sui-tree-toggle"
            [class.sui-tree-toggle-expanded]="node.expanded"
          >
            <svg class="sui-tree-toggle-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          
          <!-- Spacer for leaf nodes -->
          <div *ngIf="!hasChildren(node)" class="sui-tree-spacer"></div>
          
          <!-- Selection Checkbox -->
          <input
            *ngIf="selectionMode === 'checkbox'"
            type="checkbox"
            [checked]="isNodeSelected(node)"
            class="sui-tree-checkbox"
            (click)="$event.stopPropagation()"
            (change)="onNodeClick(node, $event)"
          />
          
          <!-- Node Label -->
          <span class="sui-tree-node-label">{{ node.label }}</span>
        </div>
        
        <!-- Children -->
        <div *ngIf="hasChildren(node) && node.expanded" class="sui-tree-children">
          <div *ngFor="let child of node.children" class="sui-tree-child">
            <div 
              class="sui-tree-node-item"
              [class.sui-tree-node-selected]="isNodeSelected(child)"
              (click)="onNodeClick(child, $event)"
            >
              <!-- Toggle Button -->
              <button
                *ngIf="hasChildren(child)"
                type="button"
                (click)="toggleNode(child); $event.stopPropagation()"
                class="sui-tree-toggle"
                [class.sui-tree-toggle-expanded]="child.expanded"
              >
                <svg class="sui-tree-toggle-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>
              
              <!-- Spacer for leaf nodes -->
              <div *ngIf="!hasChildren(child)" class="sui-tree-spacer"></div>
              
              <!-- Selection Checkbox -->
              <input
                *ngIf="selectionMode === 'checkbox'"
                type="checkbox"
                [checked]="isNodeSelected(child)"
                class="sui-tree-checkbox"
                (click)="$event.stopPropagation()"
                (change)="onNodeClick(child, $event)"
              />
              
              <!-- Node Label -->
              <span class="sui-tree-node-label">{{ child.label }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Empty State -->
    <div *ngIf="filteredValue.length === 0" class="sui-tree-empty">
      <div class="sui-tree-empty-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
      </div>
      <p class="sui-tree-empty-message">
        {{ filterValue ? 'No nodes match your search' : 'No nodes available' }}
      </p>
    </div>
  </div>
</div>

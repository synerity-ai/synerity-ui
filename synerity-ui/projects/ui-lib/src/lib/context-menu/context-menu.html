<div
  *ngIf="visible"
  #menuElement
  class="absolute z-50 bg-white border border-gray-200 rounded-lg shadow-lg py-1 min-w-48"
  [ngClass]="styleClass"
  [ngStyle]="style"
  (click)="$event.stopPropagation()"
  role="menu"
  aria-label="Context menu"
>
  <ul class="space-y-1">
    <ng-container *ngFor="let item of model">
      <li *ngIf="!item.separator" 
          class="relative"
          [class.opacity-50]="item.disabled"
          [class.cursor-not-allowed]="item.disabled">
        <div class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer transition-colors duration-150"
             [class.hover:bg-gray-100]="!item.disabled"
             [class.cursor-not-allowed]="item.disabled"
             [class.pointer-events-none]="item.disabled"
             (click)="onItemClick($event, item)"
             role="menuitem"
             [attr.aria-disabled]="item.disabled">
          <span *ngIf="item.icon" class="mr-3 text-base flex-shrink-0">{{ item.icon }}</span>
          <span class="flex-1">{{ item.label }}</span>
          <span *ngIf="hasSubmenu(item)" class="ml-2 text-gray-400">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </span>
        </div>

        <div *ngIf="hasSubmenu(item) && activeItem === item" 
             class="absolute left-full top-0 ml-1 bg-white border border-gray-200 rounded-lg shadow-lg py-1 min-w-48 z-10">
          <div class="space-y-1">
            <div *ngFor="let subItem of item.items" 
                 class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer transition-colors duration-150"
                 [class.opacity-50]="subItem.disabled"
                 [class.cursor-not-allowed]="subItem.disabled"
                 [class.pointer-events-none]="subItem.disabled"
                 (click)="onItemClick($event, subItem)"
                 role="menuitem"
                 [attr.aria-disabled]="subItem.disabled">
              <span *ngIf="subItem.icon" class="mr-3 text-base flex-shrink-0">{{ subItem.icon }}</span>
              <span class="flex-1">{{ subItem.label }}</span>
            </div>
          </div>
        </div>
      </li>
      <li *ngIf="item.separator" class="border-t border-gray-200 my-1"></li>
    </ng-container>
  </ul>
</div>

<div 
  *ngIf="visible || !popup" 
  #menuElement
  class="sui-menu"
  [class]="getMenuClass()"
  [style]="getMenuStyle()"
  role="menu"
  [attr.aria-hidden]="popup && !visible"
>
  <ul class="sui-menu-list">
    <li 
      *ngFor="let item of model; let i = index" 
      class="sui-menu-item"
      [class.sui-menu-item-disabled]="item.disabled"
      (click)="onItemClickHandler(item)"
      (mouseenter)="onItemMouseEnter(item)"
      (mouseleave)="onItemMouseLeave()"
      role="menuitem"
      [attr.aria-disabled]="item.disabled"
      [attr.tabindex]="item.disabled ? -1 : 0"
    >
      <!-- Separator -->
      <div *ngIf="item.separator" class="sui-menu-separator"></div>
      
      <!-- Menu Item -->
      <div 
        *ngIf="!item.separator" 
        class="sui-menu-item-content"
        [class.sui-menu-item-highlight]="item.highlight"
        [class.sui-menu-item-badge]="item.badge"
        [attr.data-badge]="item.badge"
        [attr.title]="item.tooltip"
      >
        <span *ngIf="item.lucideIcon" class="sui-menu-item-icon sui-lucide-icon" [attr.data-icon]="item.lucideIcon"></span>
        <span *ngIf="item.icon && !item.lucideIcon" class="sui-menu-item-icon">{{ item.icon }}</span>
        <span class="sui-menu-item-label">{{ item.label }}</span>
        <span *ngIf="item.badge && !hasSubmenu(item)" class="sui-menu-item-badge-content">{{ item.badge }}</span>
        <span *ngIf="hasSubmenu(item)" class="sui-menu-item-arrow sui-lucide-icon" data-icon="chevron-right"></span>
      </div>
      
      <!-- Submenu -->
      <div 
        *ngIf="hasSubmenu(item) && activeItem === item" 
        class="sui-menu-submenu"
        role="submenu"
      >
        <div class="sui-menu-list">
          <div 
            *ngFor="let subItem of item.items" 
            class="sui-menu-item-content sui-menu-submenu-item"
            [class.sui-menu-item-disabled]="subItem.disabled"
            (click)="onItemClickHandler(subItem)"
            role="menuitem"
            [attr.aria-disabled]="subItem.disabled"
            [attr.tabindex]="subItem.disabled ? -1 : 0"
          >
            <span *ngIf="subItem.lucideIcon" class="sui-menu-item-icon sui-lucide-icon" [attr.data-icon]="subItem.lucideIcon"></span>
            <span *ngIf="subItem.icon && !subItem.lucideIcon" class="sui-menu-item-icon">{{ subItem.icon }}</span>
            <span class="sui-menu-item-label">{{ subItem.label }}</span>
          </div>
        </div>
      </div>
    </li>
  </ul>
</div>
